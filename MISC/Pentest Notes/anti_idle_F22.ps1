Add-Type @"
using System;
using System.Runtime.InteropServices;

public class KeySender {
    [DllImport("user32.dll")]
    public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);

    public const byte VK_F22 = 0x85;
    public const uint KEYEVENTF_KEYDOWN = 0x0000;
    public const uint KEYEVENTF_KEYUP = 0x0002;

    public static void SendF22() {
        keybd_event(VK_F22, 0, KEYEVENTF_KEYDOWN, UIntPtr.Zero);
        keybd_event(VK_F22, 0, KEYEVENTF_KEYUP, UIntPtr.Zero);
    }
}
"@

Write-Host "F22 key presser started. Press Ctrl+C to stop."

while ($true) {
    [KeySender]::SendF22()
    Write-Host "F22 pressed at $(Get-Date -Format 'HH:mm:ss')"
    Start-Sleep -Seconds
59
}
